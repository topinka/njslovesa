<!doctype html>
<html lang="cs">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Německá slovesa procvičování</title>
		<meta name="description" content="Procvičování něměckých nepravidených sloves">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
	</head>
	<body>
		<nav class="navbar bg-light">
			<div class="container-fluid">
				<span class="navbar-brand mb-0 h1">NJ slovesa</span>
				<ul class="navbar-nav">
					<li class="nav-item">
						<a class="nav-link" href="https://github.com/topinka/njslovesa">GitHub</a>
					</li>
				</ul>
			</div>
		</nav>
		<div class="container">
			<ul class="nav nav-tabs nav-fill" id="pills-tab" role="tablist" style="margin-top:10px">
				<li class="nav-item" role="presentation">
				  <button class="nav-link active" id="pills-all-tab" data-bs-toggle="pill" data-bs-target="#pills-all" type="button" role="tab" aria-controls="pills-all" aria-selected="true">Všechno</button>
				</li>
				<li class="nav-item" role="presentation">
				  <button class="nav-link" id="pills-haben-tab" data-bs-toggle="pill" data-bs-target="#pills-haben" type="button" role="tab" aria-controls="pills-haben" aria-selected="false">haben/sein</button>
				</li>
			  </ul>
			  <div class="tab-content" id="pills-tabContent">
				<div class="tab-pane fade show active" id="pills-all" role="tabpanel" aria-labelledby="pills-all-tab" tabindex="0">
					<div class="mb-3" style="margin-top:10px">
						<label for="sloveso_1_cz" class="form-label">Česky</label>
						<input type="text" class="form-control" id="sloveso_1_cz" aria-describedby="sloveso_1_cz_help" disabled>
						<div class="valid-feedback">😍 Je to dobře, frajere!</div>
						<div id="sloveso_1_cz_bad" class="invalid-feedback">😭 Je to špatně, musíš se víc učit!</div>
						<div id="sloveso_1_cz_help" class="form-text">např. zahnout</div>
					</div>
					<div class="mb-3">
						<label for="sloveso_2_nj" class="form-label">Německy</label>
						<input type="text" class="form-control" id="sloveso_2_nj" aria-describedby="sloveso_2_nj_help">
						<div class="valid-feedback">😍 Je to dobře, frajere!</div>
						<div id="sloveso_2_cz_bad" class="invalid-feedback">😭 Je to špatně, musíš se víc učit!</div>
						<div id="sloveso_2_nj_help" class="form-text">např. abbiegen</div>
					</div>
					<div class="mb-3">
						<label for="sloveso_3_njpreteritum" class="form-label">Préteritum</label>
						<div class="input-group mb-3">
							<span class="input-group-text" id="sloveso_3_njpreteritum_addon">er</span>
							<input type="text" class="form-control" id="sloveso_3_njpreteritum" aria-describedby="sloveso_3_njpreteritum_help" aria-describedby="sloveso_3_njpreteritum_addon">
							<div class="valid-feedback">😍 Je to dobře, frajere!</div>
							<div id="sloveso_3_cz_bad" class="invalid-feedback">😭 Je to špatně, musíš se víc učit!</div>
						</div>
						
						<div id="sloveso_3_njpreteritum_help" class="form-text">např. er bog ab</div>
					</div>
					<div class="mb-3">
						<label for="sloveso_4_njperfektum" class="form-label">Perfektum</label>
						<div class="input-group mb-3">
							<span class="input-group-text" id="sloveso_4_njperfektum_addon">er</span>
							<input type="text" class="form-control" id="sloveso_4_njperfektum" aria-describedby="sloveso_4_njperfektum_help" aria-describedby="sloveso_4_njperfektum_addon">
							<div class="valid-feedback">😍 Je to dobře, frajere!</div>
							<div id="sloveso_4_cz_bad" class="invalid-feedback">😭 Je to špatně, musíš se víc učit!</div>
						</div>
						<div id="sloveso_4_njperfektum_help" class="form-text">např. er ist abgebogen</div>
					</div>
					<div class="form-check" style="margin-bottom: 15px;">
						<input class="form-check-input" type="checkbox" id="check-preklad">
						<label class="form-check-label" for="check-preklad">
							Nechci se učit překlad
						</label>
					  </div>
				</div>
				<div class="tab-pane fade" id="pills-haben" role="tabpanel" aria-labelledby="pills-haben-tab" tabindex="0">
					<div class="mb-3" style="margin-top:10px">
						<label for="sloveso_5_nj" class="form-label">Německy</label>
						<input type="text" class="form-control" id="sloveso_5_nj" aria-describedby="sloveso_5_nj_help" disabled>
						<div class="valid-feedback">😍 Je to dobře, frajere!</div>
						<div id="sloveso_5_cz_bad" class="invalid-feedback">😭 Je to špatně, musíš se víc učit!</div>
						<div id="sloveso_5_nj_help" class="form-text">např. ich ... gesungen</div>
					</div>
					<div class="mb-3">
						<label for="sloveso_6_nj" class="form-label">haben/sein</label>
						<input type="text" class="form-control" id="sloveso_6_nj" aria-describedby="sloveso_6_nj_help">
						<div class="valid-feedback">😍 Je to dobře, frajere!</div>
						<div id="sloveso_6_cz_bad" class="invalid-feedback">😭 Je to špatně, musíš se víc učit!</div>
						<div id="sloveso_6_nj_help" class="form-text">např. habe</div>
					</div>
				</div>

			  </div>
			<button type="submit" class="btn btn-primary" onclick="CheckIt();">Zkontrolovat</button>
			<button type="submit" class="btn btn-warning" onclick="Reveal();">Prozradit</button>
			<button type="submit" class="btn btn-danger" onclick="GenerateNew();">Vygenerovat další</button>
		</div>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js" integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk" crossorigin="anonymous"></script>
		<script>
			//https://stackoverflow.com/a/7431565/5986917
			var list;
			$(document).ready(function() {
				$.ajax({
					type: "GET",
					url: "njslovesa.csv",
					dataType: "text",
					success: function(data) {processData(data);}
				});
			});
			
			function processData(allText) {
				var allTextLines = allText.split(/\r\n|\n/);
				var headers = allTextLines[0].split(',');
				var lines = [];
				
				for (var i=1; i<allTextLines.length; i++) {
					var data = allTextLines[i].split(',');
					if (data.length == headers.length) {
						
						var tarr = [];
						for (var j=0; j<headers.length; j++) {
							tarr.push(data[j]);
						}
						lines.push(tarr);
					}
				}
				list = removeFalsyElementsFromArray(lines);
				GenerateNew();
			}
			
			//https://stackoverflow.com/a/281306/5986917
			function removeFalsyElementsFromArray(someArray) {
				var newArray = [];
				for(var index = 0; index < someArray.length; index++) {
					if(someArray[index] && someArray[index] != '') {
						newArray.push(someArray[index]);
					}
				}
				return newArray;
			}
			
			var fields = [];
			function GenerateNew() {
				clearText();
				removeClasses();
				//https://stackoverflow.com/a/5915122/5986917
				var actualindex = Math.floor(Math.random()*list.length);
				var item = list[actualindex][0];
				fields = item.split(';');
				console.log(fields);
				$("#sloveso_1_cz").val(fields[0]);
				$("#sloveso_3_njpreteritum_addon").text(GetSuperText(fields[2].split(/ (.*)/)[0]));
				$("#sloveso_4_njperfektum_addon").text(GetSuperText(fields[3].split(/ (.*)/)[0]));
				$("#sloveso_5_nj").val(fields[3].split(/ (.*)/)[0] + " ... " + fields[3].split(" ").slice(2).join(" "));
				if ($('#check-preklad').is(':checked')) {
					$("#sloveso_2_nj").val(fields[1].split('–')[0]);
					console.log("yes")
				} else {
					console.log("no")
				}
			}
			
			function CheckIt() {
				removeClasses();
				if (GetSuperText($("#sloveso_2_nj").val()) == GetSuperText(fields[1].split('–')[0])) {
					$("#sloveso_2_nj").addClass('is-valid');
					} else {
					$("#sloveso_2_nj").addClass('is-invalid');
				}
				
				
				if (GetSuperText($("#sloveso_3_njpreteritum").val()) == GetSuperText(fields[2].split(/ (.*)/)[1])) {
					$("#sloveso_3_njpreteritum").addClass('is-valid');
					} else {
					$("#sloveso_3_njpreteritum").addClass('is-invalid');
				}
				
				
				if (GetSuperText($("#sloveso_4_njperfektum").val()) == GetSuperText(fields[3].split(/ (.*)/)[1])) {
					$("#sloveso_4_njperfektum").addClass('is-valid');
					} else {
					$("#sloveso_4_njperfektum").addClass('is-invalid');
				}
				
				if (GetSuperText($("#sloveso_6_nj").val()) == GetSuperText(fields[3].split(" ")[1])) {
					$("#sloveso_6_nj").addClass('is-valid');
					} else {
					$("#sloveso_6_nj").addClass('is-invalid');
				}
			}
			
			function Reveal() {
				$("#sloveso_2_nj").val(fields[1].split('–')[0])
				$("#sloveso_3_njpreteritum").val(fields[2].split(/ (.*)/)[1])
				$("#sloveso_4_njperfektum").val(fields[3].split(/ (.*)/)[1])
				$("#sloveso_6_nj").val(fields[3].split(" ")[1])
			}
			
			function GetSuperText(text) {
				return text.toLowerCase().trim().replace(/ß/g, 'ss').replace(/ä/g, 'a');
			}
			
			function removeClasses() {
				$("#sloveso_2_nj").removeClass('is-valid');
				$("#sloveso_2_nj").removeClass('is-invalid');
				$("#sloveso_3_njpreteritum").removeClass('is-valid');
				$("#sloveso_3_njpreteritum").removeClass('is-invalid');
				$("#sloveso_4_njperfektum").removeClass('is-valid');
				$("#sloveso_4_njperfektum").removeClass('is-invalid');
				$("#sloveso_5_nj").removeClass('is-valid');
				$("#sloveso_5_nj").removeClass('is-invalid');
				$("#sloveso_6_nj").removeClass('is-valid');
				$("#sloveso_6_nj").removeClass('is-invalid');
			}
			
			function clearText() {
				$("#sloveso_2_nj").val("")
				$("#sloveso_3_njpreteritum").val("")
				$("#sloveso_4_njperfektum").val("")
				$("#sloveso_5_nj").val("")
				$("#sloveso_6_nj").val("")
			}
		</script>
	</body>
</html>